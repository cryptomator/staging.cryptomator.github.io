"use strict";const REQUEST_HUB_MANAGED_URL=LEGACY_STORE_URL+"/hub/request-managed",VALIDATE_HUB_MANAGED_REQUEST_URL=LEGACY_STORE_URL+"/hub/validate-managed-request";class HubManaged{constructor(e,t,n){this._form=e,this._feedbackData=t,this._submitData=n}validateEmail(){if(!$(this._form)[0].checkValidity()){$(this._form).find(":input").addClass("show-invalid"),this._feedbackData.errorMessage="Please fill in all required fields.";return}this._feedbackData.inProgress=!0,this._feedbackData.errorMessage="",$.ajax({url:VALIDATE_HUB_MANAGED_REQUEST_URL,type:"GET",data:{email:this._submitData.email}}).done(e=>{e.isCompanyEmail&&e.domainWithoutSuffix?this._submitData.subdomain=e.domainWithoutSuffix:this._submitData.subdomain="",this.onValidationSucceeded()}).fail(e=>{this.onValidationFailed(e.responseJSON?.message||"Validating email failed.")})}validateSubdomain(){if(!$(this._form)[0].checkValidity()){$(this._form).find(":input").addClass("show-invalid"),this._feedbackData.errorMessage="Please fill in all required fields.";return}this._feedbackData.inProgress=!0,this._feedbackData.errorMessage="",$.ajax({url:VALIDATE_HUB_MANAGED_REQUEST_URL,type:"GET",data:{subdomain:this._submitData.subdomain}}).done(e=>{this.onValidationSucceeded()}).fail(e=>{this.onValidationFailed(e.responseJSON?.message||"Validating subdomain failed.")})}validateQuantity(){if(!$(this._form)[0].checkValidity()){$(this._form).find(":input").addClass("show-invalid"),this._feedbackData.errorMessage="Please fill in all required fields.";return}this._feedbackData.inProgress=!0,this._feedbackData.errorMessage="",$.ajax({url:VALIDATE_HUB_MANAGED_REQUEST_URL,type:"GET",data:{quantity:this._submitData.quantity}}).done(e=>{this.onValidationSucceeded()}).fail(e=>{this.onValidationFailed(e.responseJSON?.message||"Validating quantity failed.")})}onValidationFailed(e){this._feedbackData.inProgress=!1,this._feedbackData.errorMessage=e}onValidationSucceeded(){this._feedbackData.currentStep++,this._feedbackData.inProgress=!1,this._feedbackData.errorMessage=""}request(){if(!$(this._form)[0].checkValidity()){$(this._form).find(":input").addClass("show-invalid"),this._feedbackData.errorMessage="Please fill in all required fields.";return}this._feedbackData.success=!1,this._feedbackData.inProgress=!0,this._feedbackData.errorMessage="",$.ajax({url:REQUEST_HUB_MANAGED_URL,type:"POST",data:this._submitData}).done(e=>{this.onRequestSucceeded(),this._submitData.acceptNewsletter&&subscribeToNewsletter(this._submitData.email,7)}).fail(e=>{this.onRequestFailed(e.responseJSON?.message||"Requesting Hub Managed failed.")})}onRequestFailed(e){this._feedbackData.success=!1,this._feedbackData.inProgress=!1,this._feedbackData.errorMessage=e}onRequestSucceeded(){this._feedbackData.success=!0,this._feedbackData.inProgress=!1,this._feedbackData.errorMessage="",window.scrollTo(0,0)}}function subdomainToURL(e){return`https://${e}.cryptomator.cloud`}